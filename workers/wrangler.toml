name = "goal-portfolio-sync"
main = "src/index.js"
compatibility_date = "2024-01-01"
workers_dev = true

# Required secret:
# wrangler secret put JWT_SECRET

# KV Namespace for sync data
# Create with: npx wrangler kv:namespace create "SYNC_KV"
# Then update the IDs below with your namespace IDs
[[kv_namespaces]]
binding = "SYNC_KV"
id = "YOUR_KV_NAMESPACE_ID_HERE"
preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID_HERE"

# Optional override for KV binding name (defaults to SYNC_KV)
# vars = { SYNC_KV_BINDING = "SYNC_KV" }

# Production environment
[env.production]
name = "goal-portfolio-sync"
vars = { ENVIRONMENT = "production", SYNC_KV_BINDING = "SYNC_KV", CORS_ORIGINS = "https://app.sg.endowus.com,https://secure.fundsupermart.com" }

# Staging environment
[env.staging]
name = "goal-portfolio-sync-staging"
vars = { ENVIRONMENT = "staging", SYNC_KV_BINDING = "SYNC_KV", CORS_ORIGINS = "https://app.sg.endowus.com,https://secure.fundsupermart.com" }

# Example secondary instance (optional)
# [env.secondary]
# name = "goal-portfolio-sync-secondary"
# vars = { ENVIRONMENT = "production", SYNC_KV_BINDING = "SYNC_KV_SECONDARY", CORS_ORIGINS = "https://app.sg.endowus.com,https://secure.fundsupermart.com" }
# kv_namespaces = [{ binding = "SYNC_KV_SECONDARY", id = "SECONDARY_KV_ID", preview_id = "SECONDARY_PREVIEW_KV_ID" }]

# Custom domain routing (optional)
# Uncomment and configure if you want a custom domain
# routes = [
#   { pattern = "sync.yourdomain.com/*", zone_name = "yourdomain.com" }
# ]

# Observability
[observability]
enabled = true

## Limits
## Free plan doesn't support CPU limits. If you upgrade, you can re-add:
## [limits]
## cpu_ms = 50
